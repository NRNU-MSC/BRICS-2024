# Библиотека для работы с SBUS на STM32
Данная библиотека служит для декодирования протокола SBUS на микроконтроллерах STM32. Протокол SBUS основан на UART(протокол последовательной передачи данных) со следующими параметрами:
- Частота 100 кбод/с
- 8 бит данных
- Бит четности even
- 2 стоп бита
- Инвертированный логический уровень сигнала

Для приема используется встроенный аппаратный UART микроконтроллера в режиме прерываний. В библиотеке реализован кольцевой буффер, что упращает работу с UART.
## Формат пакета
Пакет данных SBUS содержит 25 байт:
- Старт-байт
- 22 байта, содержащие данные 16 каналов (упакованы по 11 бит на каждый канал)
- Байт флагов
- Стоп-байт

В библиотеке реализован автоматический поиск старт и стоп - байтов а также контроль длины пакета. Пример использования библиотеки:
```C
#include "uart_ring.h"
#include "SBUS_observer.h"

ring_buffer buff = {.huart = &huart5};

int main(void)
{
  HAL_Init();
  MX_UART5_Init();
  // ...
  ring_buffer_init(&buff);  // Инициализация кольцевого буффера
  __HAL_UART_ENABLE_IT(&huart5, UART_IT_RXNE);  // Разрешение прерываний по UART
  SBUS_observer obs = { .buff = &buff};  // Создание объекта SBUS_observer

  while (1)
  {
    if (SBUS_read(&obs) == SBUS_OK){
      if (obs.channels[0] < 1500{
        // do some logic  
      }
    }
  }
}
```
